FROM prismagraphql/prisma:1.16-beta

ARG DB_HOST
ARG DB_PASSWORD
ARG PRISMA_MANAGEMENT_API_SECRET

ARG PRISMA_CONFIG_PATH
ENV PRISMA_CONFIG_PATH prisma.yml

COPY config.yml prisma.yml

RUN sed -i s/DB_HOST/$DB_HOST/g prisma.yml
RUN sed -i s/DB_PASSWORD/$AUTH_DB_PASSWORD/g prisma.yml
RUN sed -i s/PRISMA_MANAGEMENT_API_SECRET/$PRISMA_MANAGEMENT_API_SECRET/g prisma.yml

EXPOSE 4466